import{e as u}from"./iframe-D9CsFLId.js";import{r as k,e as E}from"./index-DIDRz_s2.js";const{STORY_CHANGED:O,SELECT_STORY:L}=__STORYBOOK_MODULE_CORE_EVENTS__,{makeDecorator:T,addons:p}=__STORYBOOK_MODULE_PREVIEW_API__,{global:y}=__STORYBOOK_MODULE_GLOBAL__;var C="links",{document:c,HTMLElement:R}=y;function v(e){let t={},a=(e[0]==="?"?e.substring(1):e).split("&").filter(Boolean);for(let n=0;n<a.length;n++){let i=a[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]||"")}return t}var h=e=>p.getChannel().emit(L,e),D=(e,t)=>new Promise(a=>{let{location:n}=c,i=v(n.search).id,s=e||i.split("--",2)[0],o=`/story/${u(s,t)}`,l=n.pathname.replace(/iframe\.html$/,""),_=`${n.origin+l}?${Object.entries({path:o}).map(d=>`${d[0]}=${d[1]}`).join("&")}`;a(_)}),m=e=>{let{target:t}=e;if(!(t instanceof R))return;let a=t,{sbKind:n,sbStory:i}=a.dataset;(n||i)&&(e.preventDefault(),h({kind:n,story:i}))},r=!1,K=()=>{r||(r=!0,c.addEventListener("click",m))},g=()=>{r&&(r=!1,c.removeEventListener("click",m))};T({name:"withLinks",parameterName:C,wrapper:(e,t)=>(K(),p.getChannel().once(O,g),e(t))});var b=0,S=e=>e.button===b&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey,U=(e,t=a=>{})=>{S(e)&&(e.preventDefault(),t(e))},f=class extends k.PureComponent{constructor(){super(...arguments),this.state={href:"/"},this.updateHref=async()=>{let{kind:e,title:t=e,story:a,name:n=a}=this.props;if(t&&n){let i=await D(t,n);this.setState({href:i})}},this.handleClick=()=>{let{kind:e,title:t=e,story:a,name:n=a}=this.props;t&&n&&h({title:t,name:n})}}componentDidMount(){this.updateHref()}componentDidUpdate(e){let{kind:t,title:a,story:n,name:i}=this.props;(e.kind!==t||e.story!==n||e.title!==a||e.name!==i)&&this.updateHref()}render(){let{kind:e,title:t=e,story:a,name:n=a,children:i,...s}=this.props,{href:o}=this.state;return E.createElement("a",{href:o,onClick:l=>U(l,this.handleClick),...s},i)}};f.defaultProps={children:void 0};var Y=f;export{Y as r};
