import{r as u}from"./index-DIDRz_s2.js";import{j as T}from"./jsx-runtime-BoZ7yaty.js";import{u as L}from"./useForkRef-B4JCUkpP.js";import{o as S}from"./ownerDocument-DW-IO8s5.js";const P=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function w(e){const c=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(c)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:c}function U(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const c=r=>e.ownerDocument.querySelector(`input[type="radio"]${r}`);let s=c(`[name="${e.name}"]:checked`);return s||(s=c(`[name="${e.name}"]`)),s!==e}function q(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||U(e))}function B(e){const c=[],s=[];return Array.from(e.querySelectorAll(P)).forEach((r,o)=>{const f=w(r);f===-1||!q(r)||(f===0?c.push(r):s.push({documentOrder:o,tabIndex:f,node:r}))}),s.sort((r,o)=>r.tabIndex===o.tabIndex?r.documentOrder-o.documentOrder:r.tabIndex-o.tabIndex).map(r=>r.node).concat(c)}function G(){return!0}function Y(e){const{children:c,disableAutoFocus:s=!1,disableEnforceFocus:r=!1,disableRestoreFocus:o=!1,getTabbable:f=B,isEnabled:v=G,open:a}=e,x=u.useRef(!1),g=u.useRef(null),d=u.useRef(null),i=u.useRef(null),p=u.useRef(null),b=u.useRef(!1),n=u.useRef(null),j=L(c.ref,n),I=u.useRef(null);u.useEffect(()=>{!a||!n.current||(b.current=!s)},[s,a]),u.useEffect(()=>{if(!a||!n.current)return;const t=S(n.current);return n.current.contains(t.activeElement)||(n.current.hasAttribute("tabIndex")||n.current.setAttribute("tabIndex","-1"),b.current&&n.current.focus()),()=>{o||(i.current&&i.current.focus&&(x.current=!0,i.current.focus()),i.current=null)}},[a]),u.useEffect(()=>{if(!a||!n.current)return;const t=S(n.current),m=l=>{I.current=l,!(r||!v()||l.key!=="Tab")&&t.activeElement===n.current&&l.shiftKey&&(x.current=!0,d.current&&d.current.focus())},h=()=>{const l=n.current;if(l===null)return;if(!t.hasFocus()||!v()||x.current){x.current=!1;return}if(l.contains(t.activeElement)||r&&t.activeElement!==g.current&&t.activeElement!==d.current)return;if(t.activeElement!==p.current)p.current=null;else if(p.current!==null)return;if(!b.current)return;let E=[];if((t.activeElement===g.current||t.activeElement===d.current)&&(E=f(n.current)),E.length>0){var N,R;const O=!!((N=I.current)!=null&&N.shiftKey&&((R=I.current)==null?void 0:R.key)==="Tab"),y=E[0],A=E[E.length-1];typeof y!="string"&&typeof A!="string"&&(O?A.focus():y.focus())}else l.focus()};t.addEventListener("focusin",h),t.addEventListener("keydown",m,!0);const D=setInterval(()=>{t.activeElement&&t.activeElement.tagName==="BODY"&&h()},50);return()=>{clearInterval(D),t.removeEventListener("focusin",h),t.removeEventListener("keydown",m,!0)}},[s,r,o,v,a,f]);const k=t=>{i.current===null&&(i.current=t.relatedTarget),b.current=!0,p.current=t.target;const m=c.props.onFocus;m&&m(t)},F=t=>{i.current===null&&(i.current=t.relatedTarget),b.current=!0};return T.jsxs(u.Fragment,{children:[T.jsx("div",{tabIndex:a?0:-1,onFocus:F,ref:g,"data-testid":"sentinelStart"}),u.cloneElement(c,{ref:j,onFocus:k}),T.jsx("div",{tabIndex:a?0:-1,onFocus:F,ref:d,"data-testid":"sentinelEnd"})]})}export{Y as F};
