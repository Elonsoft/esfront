import{r as u}from"./index-DIDRz_s2.js";import{j as R}from"./jsx-runtime-BoZ7yaty.js";import{u as w}from"./useForkRef-Cmn-Dh7x.js";import{g as L}from"./getReactElementRef-BCGM00pR.js";import{o as S}from"./ownerDocument-DW-IO8s5.js";const P=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function K(e){const c=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(c)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:c}function U(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const c=r=>e.ownerDocument.querySelector(`input[type="radio"]${r}`);let s=c(`[name="${e.name}"]:checked`);return s||(s=c(`[name="${e.name}"]`)),s!==e}function $(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||U(e))}function q(e){const c=[],s=[];return Array.from(e.querySelectorAll(P)).forEach((r,o)=>{const f=K(r);f===-1||!$(r)||(f===0?c.push(r):s.push({documentOrder:o,tabIndex:f,node:r}))}),s.sort((r,o)=>r.tabIndex===o.tabIndex?r.documentOrder-o.documentOrder:r.tabIndex-o.tabIndex).map(r=>r.node).concat(c)}function B(){return!0}function z(e){const{children:c,disableAutoFocus:s=!1,disableEnforceFocus:r=!1,disableRestoreFocus:o=!1,getTabbable:f=q,isEnabled:g=B,open:a}=e,x=u.useRef(!1),I=u.useRef(null),d=u.useRef(null),i=u.useRef(null),p=u.useRef(null),b=u.useRef(!1),n=u.useRef(null),j=w(L(c),n),v=u.useRef(null);u.useEffect(()=>{!a||!n.current||(b.current=!s)},[s,a]),u.useEffect(()=>{if(!a||!n.current)return;const t=S(n.current);return n.current.contains(t.activeElement)||(n.current.hasAttribute("tabIndex")||n.current.setAttribute("tabIndex","-1"),b.current&&n.current.focus()),()=>{o||(i.current&&i.current.focus&&(x.current=!0,i.current.focus()),i.current=null)}},[a]),u.useEffect(()=>{if(!a||!n.current)return;const t=S(n.current),m=l=>{v.current=l,!(r||!g()||l.key!=="Tab")&&t.activeElement===n.current&&l.shiftKey&&(x.current=!0,d.current&&d.current.focus())},h=()=>{var F,N;const l=n.current;if(l===null)return;if(!t.hasFocus()||!g()||x.current){x.current=!1;return}if(l.contains(t.activeElement)||r&&t.activeElement!==I.current&&t.activeElement!==d.current)return;if(t.activeElement!==p.current)p.current=null;else if(p.current!==null)return;if(!b.current)return;let E=[];if((t.activeElement===I.current||t.activeElement===d.current)&&(E=f(n.current)),E.length>0){const O=!!((F=v.current)!=null&&F.shiftKey&&((N=v.current)==null?void 0:N.key)==="Tab"),y=E[0],A=E[E.length-1];typeof y!="string"&&typeof A!="string"&&(O?A.focus():y.focus())}else l.focus()};t.addEventListener("focusin",h),t.addEventListener("keydown",m,!0);const D=setInterval(()=>{t.activeElement&&t.activeElement.tagName==="BODY"&&h()},50);return()=>{clearInterval(D),t.removeEventListener("focusin",h),t.removeEventListener("keydown",m,!0)}},[s,r,o,g,a,f]);const k=t=>{i.current===null&&(i.current=t.relatedTarget),b.current=!0,p.current=t.target;const m=c.props.onFocus;m&&m(t)},T=t=>{i.current===null&&(i.current=t.relatedTarget),b.current=!0};return R.jsxs(u.Fragment,{children:[R.jsx("div",{tabIndex:a?0:-1,onFocus:T,ref:I,"data-testid":"sentinelStart"}),u.cloneElement(c,{ref:j,onFocus:k}),R.jsx("div",{tabIndex:a?0:-1,onFocus:T,ref:d,"data-testid":"sentinelEnd"})]})}export{z as F};
